# Phase A: 分析 (Analyze)

> *架构师思维：分解与规划*

在 Phase G 获得初步解决方案后，你需要对其进行解构和风险评估。这是从"有什么方案"到"怎么做"的关键转换。

---

## 工作流总览

```
        Phase G 产出
           方案雏形
              │
              ▼
    ┌─────────────────────┐
    │ 1. 定义核心与边界   │
    │    MVP 是什么？     │
    └─────────────────────┘
              │
              ▼
    ┌─────────────────────┐
    │ 2. 排名优于分数     │
    │    优先级排序       │
    └─────────────────────┘
              │
              ▼
    ┌─────────────────────┐
    │ 3. 风险与依赖评估   │
    └─────────────────────┘
              │
              ▼
         执行计划
```

---

## 1. 定义核心与边界

### 目标
明确此任务的"最小可用产品"（MVP），防止范围蔓延。

### 三类清单

| 类型 | 定义 | 示例 |
|------|------|------|
| **核心功能** | 不做这事就没意义 | 用户认证、数据存储 |
| **锦上添花** | 有了更好，没有也能用 | UI 动画、导出功能 |
| **明确不做** | 本次明确排除 | 支付集成、多语言 |

### MVP 定义模板

```markdown
## MVP 定义

### 本次必须完成
- [ ] 功能 A
- [ ] 功能 B
- [ ] 功能 C

### 下次再做
- [ ] 功能 D（依赖外部资源）
- [ ] 功能 E（优先级较低）

### 明确不做
- [ ] 功能 X（不在项目范围内）
- [ ] 功能 Y（与其他方案冲突）
```

### 实践要点

- **MVP 不是"简化版"，而是"可用的最小闭环"**
- 问自己："没有这个功能，用户能用吗？"不能 → 核心；能 → 锦上添花
- 处于边界时，优先排除而非纳入

### 反模式警示

- ❌ "先把简单的都做了" — 没有优先级
- ❌ "这个功能也很重要" — 模糊核心边界
- ✅ "至少要能 X，否则无法验收"
- ✅ "Y 很好，但不在本次范围"

---

## 2. 排名优于分数 (Rank > Score)

### 核心思想
回答"哪个最重要？"，而不是"每个要多久？"

### 排序方法

#### 方法一：必须性排序
按"阻塞程度"排序：

| 排序 | 标准 |
|------|------|
| P0 | 不做这事，后续无法进行 |
| P1 | 核心功能，不做则失败 |
| P2 | 重要，但可延后 |
| P3 | 锦上添花 |

#### 方法二：依赖链排序
按"依赖关系"排序：

```
A (基础)
├── B (依赖 A)
│   └── D (依赖 B)
└── C (依赖 A)
    └── E (依赖 C)
```

排序：A → B/C → D/E

### 优先级表达模板

```markdown
## 执行优先级

| 优先级 | 任务 | 理由 |
|--------|------|------|
| P0 | [任务 A] | 后续所有任务的基础 |
| P1 | [任务 B] | 核心功能，必须完成 |
| P1 | [任务 C] | 核心功能，必须完成 |
| P2 | [任务 D] | 重要但可延后 |
| P3 | [任务 E] | 锦上添花 |
```

### 实践要点

- 避免"都重要"的模糊判断
- 优先考虑依赖关系，而非工作量
- 时间估算在实现阶段再做，分析阶段只排优先级

### 反模式警示

- ❌ "这个要2小时，那个要1小时" — 过早估算
- ❌ "都很重要，先做简单的" — 缺乏优先级
- ✅ "A 是 B 的前置条件，先做 A"
- ✅ "P0 是阻塞项，必须先解决"

---

## 3. 风险与依赖评估

### 技术依赖

明确需要哪些工具/库/服务：

| 依赖项 | 类型 | 风险等级 | 缓解方案 |
|--------|------|----------|----------|
| Python 3.10+ | 运行时 | 低 | 版本明确，易于安装 |
| OpenAI API | 外部服务 | 中 | 需要 API key，有成本 |
| 专有 CLI | 工具 | 高 | 需要手动安装，兼容性未知 |

### 知识依赖

明确需要哪些背景知识：

| 领域 | 当前掌握程度 | 风险 | 缓解方案 |
|------|--------------|------|----------|
| HTTP 协议 | 熟悉 | 低 | - |
| Docker 容器 | 了解 | 中 | 查阅官方文档 |
| 领域算法 | 陌生 | 高 | Phase G 学习，或寻求专家资源 |

### 潜在风险

| 风险 | 概率 | 影响 | 应对 |
|------|------|------|------|
| API 变更 | 中 | 高 | 版本锁定，关注更新 |
| 性能瓶颈 | 低 | 中 | 先实现，后优化 |
| 依赖不可用 | 低 | 高 | 提前验证，准备替代方案 |

### 评估模板

```markdown
## 风险与依赖评估

### 技术依赖
- [ ] 依赖 A: [风险等级] [缓解方案]
- [ ] 依赖 B: [风险等级] [缓解方案]

### 知识依赖
- [ ] 领域 A: [掌握程度] [风险] [应对]
- [ ] 领域 B: [掌握程度] [风险] [应对]

### 风险清单
- [ ] 风险 A: [概率/影响] [应对措施]
- [ ] 风险 B: [概率/影响] [应对措施]
```

### 实践要点

- 区分"依赖"（必须的）和"选项"（可替代的）
- 风险评估关注"影响"而非"概率" — 影响大的风险要提前应对
- 记录缓解方案，不只是列出风险

---

## 分析产出标准

Phase A 完成后，应产出：

| 项 | 必需性 | 说明 |
|----|--------|------|
| MVP 定义 | 必需 | 核心/锦上添花/不做 |
| 优先级排序 | 必需 | P0-P3 清晰划分 |
| 执行计划 | 必需 | 基于优先级的执行顺序 |
| 依赖清单 | 必需 | 技术和知识依赖 |
| 风险评估 | 推荐 | 风险和缓解方案 |

### 示例产出

```markdown
## [项目名称] 分析报告

### MVP 定义
**核心**: 用户认证、数据存储、基础查询
**锦上添花**: 数据导出、历史记录
**明确不做**: 社交分享、多设备同步

### 优先级
1. (P0) 搭建基础项目结构
2. (P1) 实现用户认证
3. (P1) 实现数据存储
4. (P1) 实现基础查询
5. (P2) 添加数据导出

### 依赖
- Python 3.10+
- Flask 框架
- SQLite

### 风险
- Flask 版本兼容性: 版本锁定为 2.x
```

---

分析完成后，进入 [Phase I: 实现](./03-implement.md)。
